# Technical Debt: AWS user is over-permissioned
# Technical Debt: AWS user needs cross account access
# Technical Debt: Add SES deployment (with SQS, SNS & Lambda)
# Technical Debt: Add CloudSearch configuration
# Technical Debt: Add merge to higher environments

general:
  branches:
    only:
      - production
      - staging
      - development
      
machine:
  timezone:
    America/Los_Angeles
  node:
    version: 7.2.0

test:
  override:
    - npm run test-unit

deployment:
  production:
    branch: production
    commands:
      - ./deployment/deploy_production.sh
  staging:
    branch: production
    commands:
      - ./deployment/deploy_staging.sh
  development:
    branch: development
    commands:
      - serverless deploy --stage development
      - npm run test-integration
      - ./deployment/deploy_development.sh
      # - merge to staging