const expect = require('chai').expect;
const du = require('@6crm/sixcrmcore/util/debug-utilities.js').default;

process.env.SIX_VERBOSE = 2;
describe('Redis Cluster Connection Test', function () {

    it('should connect to the Redis cluster.', function (done) {

      var redis = require('redis-cluster').clusterClient;

      var firstLink = '34.204.230.178'; // Used to discover the rest of the cluster

      new redis.clusterInstance(firstLink, function (error, r) {

        expect(error).to.be.null;

        r.set('foo', 'bar', function (error, reply) {

          expect(error).to.be.null;

          expect(reply).to.be.equal('OK');

          du.debug('Set Reply:', reply);

          r.get('foo', function (error, reply) {

            expect(error).to.be.null;

            expect(reply).to.be.equal('bar');

            du.debug('Get Reply:', reply);

            done();

          });

        });

      });

    });

});
